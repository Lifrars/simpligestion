"use strict";(self.webpackChunkvex=self.webpackChunkvex||[]).push([[4872],{4872:(at,M,r)=>{r.r(M),r.d(M,{DashboardAnalyticsComponent:()=>tt});var v=r(617),p=r(2296),x=r(97),D=r(9565),l=r(5313),A=r(1476),g=r(3566),f=r(5195),d=r(4170),_=r(4516),b=r(8525),C=r(3680),u=r(9347),c=r(6223),Z=r(6814),U=r(3519),h=r.n(U),t=r(9212),q=r(9862);let y=(()=>{class e{constructor(a){this.http=a,this.apiUrl="https://ppi.miclickderecho.com/plantilla/MomentoValorativo2/api_pipe/api.php"}getMascotas(){return this.http.get(`${this.apiUrl}?consultarMascotas=true`)}addMascota(a){return this.http.post(`${this.apiUrl}?agregarMascota=true`,a)}getClientes(){return this.http.get(`${this.apiUrl}?obtenerClientes=true`)}getMedicamentos(){return this.http.get(`${this.apiUrl}?obtenerMedicamentos=true`)}deleteMascota(a){return this.http.delete(`${this.apiUrl}?eliminarMascota=true&id_mascota=${a}`)}updateMascota(a){return this.http.put(`${this.apiUrl}/mascotas/${a.id_mascota}`,a)}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(q.eN))};static#a=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function N(e,i){if(1&e&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.Q6J("value",a.id_cliente),t.xp6(),t.hij(" ",a.nombre_completo," ")}}function z(e,i){if(1&e&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.Q6J("value",a.id_medicamento),t.xp6(),t.hij(" ",a.nombre," ")}}let T=(()=>{class e{constructor(a,n,o,s){this.dialogRef=a,this.fb=n,this.dashboardService=o,this.data=s,this.clientes=[],this.medicamentos=[],this.isEditMode=!1,this.mascotaForm=this.fb.group({nombre:[this.data?.mascota?.nombre_mascota||"",c.kI.required],raza:[this.data?.mascota?.raza||"",c.kI.required],edad:[this.data?.mascota?.edad||"",c.kI.required],peso:[this.data?.mascota?.peso||"",c.kI.required],cliente:[this.data?.mascota?.id_cliente||"",c.kI.required],medicamento:[this.data?.mascota?.id_medicamento||""]}),this.loadClientes(),this.loadMedicamentos()}loadClientes(){this.dashboardService.getClientes().subscribe({next:a=>{if(a.success){if(this.clientes=a.clientes,this.data?.mascota?.id_cliente){const n=this.clientes.find(o=>o.id_cliente===this.data.mascota.id_cliente);n&&this.mascotaForm.patchValue({cliente:n.id_cliente})}}else console.error("Error al cargar los clientes:",a.message)},error:a=>{console.error("Error al cargar los clientes:",a)}})}loadMedicamentos(){this.dashboardService.getMedicamentos().subscribe({next:a=>{if(a.success){if(this.medicamentos=a.medicamentos,this.data?.mascota?.id_medicamento){const n=this.medicamentos.find(o=>o.id_medicamento===this.data.mascota.id_medicamento);n&&this.mascotaForm.patchValue({medicamento:n.id_medicamento})}}else console.error("Error al cargar los medicamentos:",a.message)},error:a=>{console.error("Error al cargar los medicamentos:",a)}})}onCancel(){this.dialogRef.close()}onSave(){this.mascotaForm.valid&&this.agregarMascota()}agregarMascota(){this.dashboardService.addMascota(this.mascotaForm.value).subscribe(a=>{a.success&&h().fire({icon:"success",title:"\xa1Mascota agregada!",text:"La mascota se agreg\xf3 correctamente a la base de datos",confirmButtonText:"Ok"}).then(()=>{this.dialogRef.close(),window.location.reload()})},a=>{console.error("Error al agregar la mascota",a),h().fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al intentar agregar la mascota. Por favor, int\xe9ntalo de nuevo.",confirmButtonText:"Ok"})})}static#t=this.\u0275fac=function(n){return new(n||e)(t.Y36(u.so),t.Y36(c.qu),t.Y36(y),t.Y36(u.WI))};static#a=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-mascota-dialog"]],standalone:!0,features:[t.jDz],decls:39,vars:5,consts:[["mat-dialog-title",""],[1,"scrollable-content"],[3,"formGroup"],[1,"form-grid"],[1,"form-row"],["appearance","outline",1,"form-field"],["matInput","","formControlName","nombre","required",""],["matInput","","formControlName","raza","required",""],["matInput","","formControlName","edad","type","number","required",""],["matInput","","formControlName","peso","type","number","required",""],["formControlName","cliente"],[3,"value",4,"ngFor","ngForOf"],["formControlName","medicamento"],["align","end"],["mat-button","",3,"click"],["mat-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(n,o){1&n&&(t.TgZ(0,"h2",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),t._uU(8,"Nombre de la Mascota"),t.qZA(),t._UZ(9,"input",6),t.qZA(),t.TgZ(10,"mat-form-field",5)(11,"mat-label"),t._uU(12,"Raza"),t.qZA(),t._UZ(13,"input",7),t.qZA()(),t.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),t._uU(17,"Edad"),t.qZA(),t._UZ(18,"input",8),t.qZA(),t.TgZ(19,"mat-form-field",5)(20,"mat-label"),t._uU(21,"Peso"),t.qZA(),t._UZ(22,"input",9),t.qZA()(),t.TgZ(23,"div",4)(24,"mat-form-field",5)(25,"mat-label"),t._uU(26,"Cliente"),t.qZA(),t.TgZ(27,"mat-select",10),t.YNc(28,N,2,2,"mat-option",11),t.qZA()(),t.TgZ(29,"mat-form-field",5)(30,"mat-label"),t._uU(31,"Medicamento"),t.qZA(),t.TgZ(32,"mat-select",12),t.YNc(33,z,2,2,"mat-option",11),t.qZA()()()()()(),t.TgZ(34,"mat-dialog-actions",13)(35,"button",14),t.NdJ("click",function(){return o.onCancel()}),t._uU(36,"Cancelar"),t.qZA(),t.TgZ(37,"button",15),t.NdJ("click",function(){return o.onSave()}),t._uU(38," Guardar "),t.qZA()()),2&n&&(t.xp6(),t.Oqu(o.data.mascota?"Editar Mascota":"Agregar Mascota"),t.xp6(2),t.Q6J("formGroup",o.mascotaForm),t.xp6(25),t.Q6J("ngForOf",o.clientes),t.xp6(5),t.Q6J("ngForOf",o.medicamentos),t.xp6(4),t.Q6J("disabled",o.mascotaForm.invalid))},dependencies:[u.Is,u.uh,u.H8,u.xY,d.lN,d.KE,d.hX,_.c,_.Nt,p.ot,p.lW,b.LD,b.gD,C.ey,C.Ng,c.UX,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.Q7,c.sg,c.u,Z.ez,Z.sg],styles:['@charset "UTF-8";.scrollable-content[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;padding-right:16px}.form-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:16px}.form-field[_ngcontent-%COMP%]{flex:1}']})}return e})();var S=r(376);function R(e,i){if(1&e&&(t.TgZ(0,"mat-option",29),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.Q6J("value",a),t.xp6(),t.Oqu(a)}}function F(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1," ID "),t.qZA())}function J(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(),t.hij(" ",a.id_mascota," ")}}function Q(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1," Nombre "),t.qZA())}function E(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(),t.hij(" ",a.nombre_mascota," ")}}function Y(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1," Raza "),t.qZA())}function B(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(),t.hij(" ",a.raza," ")}}function $(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1," Edad "),t.qZA())}function O(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(),t.hij(" ",a.edad," ")}}function w(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1," Peso "),t.qZA())}function k(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(),t.hij(" ",a.peso," ")}}function I(e,i){1&e&&(t.TgZ(0,"th",30),t._uU(1," Cliente "),t.qZA())}function j(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(),t.hij(" ",a.nombre_cliente," ")}}function G(e,i){1&e&&(t.TgZ(0,"th",32),t._uU(1," Medicamento "),t.qZA())}function L(e,i){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const a=i.$implicit;t.xp6(),t.hij(" ",a.nombre_medicamento," ")}}function H(e,i){1&e&&(t.TgZ(0,"th",32),t._uU(1," Acciones "),t.qZA())}function P(e,i){if(1&e){const a=t.EpF();t.TgZ(0,"td",31)(1,"button",33),t.NdJ("click",function(){const s=t.CHM(a).$implicit,m=t.oxw();return t.KtG(m.openEditMascotaModal(s))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",34),t.NdJ("click",function(){const s=t.CHM(a).$implicit,m=t.oxw();return t.KtG(m.eliminarMascota(s.id_mascota))}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function X(e,i){1&e&&t._UZ(0,"tr",35)}function V(e,i){1&e&&t._UZ(0,"tr",36)}const W=()=>["Dashboards","Mascotas"],K=()=>[5,10,20];let tt=(()=>{class e{constructor(a,n,o){this.configService=a,this.dashboardService=n,this.dialog=o,this.searchTerm="",this.selectedRaza="",this.razas=["Bulldog","Golden Retriever","Beagle","Labrador"],this.displayedColumns=["id","nombre","raza","edad","peso","cliente","medicamento","acciones"],this.dataSource=new l.by}ngOnInit(){this.footerVisibleChange(!1),this.obtenerMascotas()}obtenerMascotas(){this.dashboardService.getMascotas().subscribe(a=>{a&&Array.isArray(a.mascotas)&&(this.dataSource.data=a.mascotas,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)},a=>{console.error("Error al obtener las mascotas",a),this.dataSource.data=[]})}applyFilter(){this.dataSource.filterPredicate=(a,n)=>(n.toLowerCase(),a.nombre_mascota.toLowerCase().includes(this.searchTerm.toLowerCase())&&(!this.selectedRaza||a.raza===this.selectedRaza)),this.dataSource.filter=`${this.searchTerm}${this.selectedRaza}`}onSearchTermChange(){this.applyFilter()}onRazaChange(){this.applyFilter()}footerVisibleChange(a){this.configService.updateConfig({footer:{visible:!1}})}agregarMascota(){this.dialog.open(T,{width:"400px"}).afterClosed().subscribe(n=>{n&&this.dashboardService.addMascota(n).subscribe(o=>{this.obtenerMascotas()},o=>{console.error("Error al agregar la mascota",o)})})}openAddMascotaModal(){this.dialog.open(T,{width:"800px",data:{}}).afterClosed().subscribe(n=>{n&&this.obtenerMascotas()})}openEditMascotaModal(a){this.dialog.open(T,{width:"800px",data:{mascota:a}}).afterClosed().subscribe(o=>{o&&this.dashboardService.updateMascota(o).subscribe(()=>{h().fire("Actualizado","La mascota ha sido actualizada correctamente.","success"),this.obtenerMascotas()},s=>{h().fire("Error","Ocurri\xf3 un error al intentar actualizar la mascota.","error")})})}eliminarMascota(a){h().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"}).then(n=>{n.isConfirmed&&this.dashboardService.deleteMascota(a).subscribe(()=>{h().fire("Eliminado","La mascota ha sido eliminada correctamente.","success"),this.obtenerMascotas()},o=>{console.error("Error al eliminar la mascota",o),h().fire("Error","Ocurri\xf3 un error al intentar eliminar la mascota.","error")})})}static#t=this.\u0275fac=function(n){return new(n||e)(t.Y36(S.Y),t.Y36(y),t.Y36(u.uw))};static#a=this.\u0275cmp=t.Xpm({type:e,selectors:[["vex-dashboard-analytics"]],viewQuery:function(n,o){if(1&n&&(t.Gf(A.NW,5),t.Gf(g.YE,5)),2&n){let s;t.iGM(s=t.CRH())&&(o.paginator=s.first),t.iGM(s=t.CRH())&&(o.sort=s.first)}},standalone:!0,features:[t.jDz],decls:59,vars:10,consts:[["current","Mascotas"],[1,"flex-auto",3,"crumbs"],["color","primary","mat-icon-button","","type","button",1,"ml-2"],["svgIcon","mat:add"],[1,"container","p-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-semibold","text-gray-700"],["mat-flat-button","","color","primary",3,"click"],["appearance","outline"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelChange"],["matSuffix",""],[3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","raza"],["matColumnDef","edad"],["matColumnDef","peso"],["matColumnDef","cliente"],["matColumnDef","medicamento"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"value"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,o){1&n&&(t.TgZ(0,"vex-secondary-toolbar",0),t._UZ(1,"vex-breadcrumbs",1),t.TgZ(2,"button",2),t._UZ(3,"mat-icon",3),t.qZA()(),t.TgZ(4,"div",4)(5,"div",5)(6,"h2",6),t._uU(7,"Informaci\xf3n de Mascotas"),t.qZA(),t.TgZ(8,"button",7),t.NdJ("click",function(){return o.openAddMascotaModal()}),t.TgZ(9,"mat-icon"),t._uU(10,"add"),t.qZA(),t._uU(11," Agregar Mascota "),t.qZA()(),t.TgZ(12,"mat-card")(13,"mat-card-header")(14,"mat-card-title"),t._uU(15,"B\xfasqueda de Mascotas"),t.qZA()(),t.TgZ(16,"mat-card-content")(17,"div",5)(18,"mat-form-field",8)(19,"mat-label"),t._uU(20,"Buscar por nombre"),t.qZA(),t.TgZ(21,"input",9),t.NdJ("ngModelChange",function(m){return o.searchTerm=m})("ngModelChange",function(){return o.onSearchTermChange()}),t.qZA(),t.TgZ(22,"mat-icon",10),t._uU(23,"search"),t.qZA()(),t.TgZ(24,"mat-form-field",8)(25,"mat-label"),t._uU(26,"Filtrar por raza"),t.qZA(),t.TgZ(27,"mat-select",11),t.NdJ("ngModelChange",function(m){return o.selectedRaza=m})("ngModelChange",function(){return o.onRazaChange()}),t.TgZ(28,"mat-option",12),t._uU(29,"Todas"),t.qZA(),t.YNc(30,R,2,2,"mat-option",13),t.qZA()()(),t.TgZ(31,"table",14),t.ynx(32,15),t.YNc(33,F,2,0,"th",16)(34,J,2,1,"td",17),t.BQk(),t.ynx(35,18),t.YNc(36,Q,2,0,"th",16)(37,E,2,1,"td",17),t.BQk(),t.ynx(38,19),t.YNc(39,Y,2,0,"th",16)(40,B,2,1,"td",17),t.BQk(),t.ynx(41,20),t.YNc(42,$,2,0,"th",16)(43,O,2,1,"td",17),t.BQk(),t.ynx(44,21),t.YNc(45,w,2,0,"th",16)(46,k,2,1,"td",17),t.BQk(),t.ynx(47,22),t.YNc(48,I,2,0,"th",16)(49,j,2,1,"td",17),t.BQk(),t.ynx(50,23),t.YNc(51,G,2,0,"th",24)(52,L,2,1,"td",17),t.BQk(),t.ynx(53,25),t.YNc(54,H,2,0,"th",24)(55,P,7,0,"td",17),t.BQk(),t.YNc(56,X,1,0,"tr",26)(57,V,1,0,"tr",27),t.qZA(),t._UZ(58,"mat-paginator",28),t.qZA()()()),2&n&&(t.xp6(),t.Q6J("crumbs",t.DdM(8,W)),t.xp6(20),t.Q6J("ngModel",o.searchTerm),t.xp6(6),t.Q6J("ngModel",o.selectedRaza),t.xp6(3),t.Q6J("ngForOf",o.razas),t.xp6(),t.Q6J("dataSource",o.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(),t.Q6J("pageSizeOptions",t.DdM(9,K)))},dependencies:[D.P,x.D,p.ot,p.lW,p.RK,v.Ps,v.Hw,l.p0,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,f.QW,f.a8,f.dn,f.dk,f.n5,A.TU,A.NW,g.JX,g.YE,g.nU,d.lN,d.KE,d.hX,d.R9,_.c,_.Nt,b.LD,b.gD,C.ey,C.Ng,c.u5,c.Fj,c.JJ,c.On,Z.ez,Z.sg]})}return e})()}}]);